# Greg Game Bar Widget

This project is a basic Xbox Game Bar widget for Windows that displays and controls your Greg music playlist.  It connects to your existing Flask/Socket.IO backend running locally (default: `http://localhost:3000`).

## Features

- Displays the current playlist and highlights the playing track.
- Supports adding new tracks by title/URL, pausing, resuming, skipping and stopping via buttons.
- Connects to the backend using Socket.IO and REST APIs.
- Runs as an Xbox Game Bar widget; it remains visible on top of full‑screen games when pinned.
- Supports sideload deployment (no Microsoft store account required).

## Folder structure

```
gamebar_widget/
├── GregGameBarWidget.csproj    Project file
├── Package.appxmanifest        Manifest with widget capabilities
├── App.xaml                   Application definition
├── App.xaml.cs                Application code‑behind
├── MainPage.xaml              Widget page UI
├── MainPage.xaml.cs           Widget page code‑behind
├── Assets/
│   ├── index.html            HTML overlay page loaded in the WebView
│   ├── overlay.js            JavaScript for the overlay page
│   └── overlay.css           Styling for the overlay page
└── README.md                 This file
```

## How to build and sideload

These steps assume you're running Windows 10/11 with the **Game Bar** installed.

1. **Enable developer mode** in Windows settings:
   - Open *Settings → Privacy & Security → For developers*.
   - Enable "Developer Mode" (you can disable it after installation).

2. **Install Visual Studio 2022 or later** with the "Universal Windows Platform development" workload.

3. **Open the solution**:
   - Create a new folder and copy the contents of this `gamebar_widget` directory into it.
   - Open the `.csproj` file with Visual Studio.  It will load the UWP project.

4. **Configure the backend URL**:
   - In `Assets/overlay.js`, change the `const DEFAULT_SERVER = "http://localhost:3000";` to match your Flask server if needed.

5. **Build and sign the package**:
   - Right–click the project in Solution Explorer → *Publish → Create App Packages…*.
   - Choose **Sideloading** and check "Sign with existing certificate or a self‑signed certificate".
   - If you don't have a certificate, create one by clicking "Create test certificate".  Make sure to pick a password you can remember.
   - Choose a folder to output the package and finish the wizard.  Visual Studio will generate a `.msixbundle` file.

6. **Distribute the package**:
   - Copy the `.msixbundle` and the certificate `.cer` file to any machine you want to install the widget.

7. **Install on other machines (no store needed)**:
   - On each machine, double–click the `.cer` certificate and install it to the "Trusted People" store for the current user.
   - Run the provided `install.ps1` script (see below) from a PowerShell window with administrative privileges to install the package:
     ```powershell
     Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
     .\install.ps1
     ```

## install.ps1

A sample PowerShell install script is provided at the repository root:

```
Import-Certificate -FilePath "./GregOverlay.cer" -CertStoreLocation Cert:\CurrentUser\TrustedPeople | Out-Null
# Optionally allow trusted app installs (only needed once):
# reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AppModelUnlock" /t REG_DWORD /f /v "AllowAllTrustedApps" /d 1 | Out-Null
Add-AppxPackage "./GregOverlay.msixbundle"
Write-Host "Installation complete.  Open Xbox Game Bar (Win+G) and pin the Greg overlay widget."
```

Make sure to replace the filenames with the actual certificate and package names generated by Visual Studio.

## Usage

- Start your Flask/Socket.IO backend (e.g. `python main.py` in your Greg project).
- Press `Win + G` in your game to open the Xbox Game Bar.
- Click the widgets menu and find "Greg Game Bar Widget".
- Pin the widget so it stays visible during gameplay.
- Use the UI to add tracks and control playback.

## Disclaimer

This project is provided as a sample.  You are responsible for complying with all policies and terms of service for Xbox Game Bar and your games.  This widget does not modify game files nor interact with the game process.  It simply renders a web page in an overlay.