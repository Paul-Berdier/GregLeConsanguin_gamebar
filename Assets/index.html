<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Greg Overlay</title>
  <link rel="stylesheet" href="overlay.css" />
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script defer src="overlay.js"></script>
</head>
<body>

<button class="settings-toggle" id="settingsToggle" title="Configuration">⚙️</button>

<div class="config-panel hidden" id="configPanel">
  <div class="config-header">
    <span class="config-title">Configuration</span>
    <button class="config-close" id="configClose" title="Fermer">✕</button>
  </div>

  <!-- Domaine serveur -->
  <input type="text" id="configServerInput" class="config-input"
         placeholder="https://ton-app.up.railway.app" autocomplete="off" />

  <!-- Zone d’identification / état OAuth -->
  <div id="authBlock" class="status-message" style="margin:8px 0;"></div>
  <div id="authButtons" style="display:flex; gap:8px; margin-bottom:8px;">
    <a class="config-save" href="/login" style="text-align:center; text-decoration:none; display:none;" id="loginBtn">
      Se connecter avec Discord
    </a>
    <a class="config-save" href="/logout" style="text-align:center; text-decoration:none; background:#ef4444; display:none;" id="logoutBtn">
      Se déconnecter
    </a>
  </div>

  <!-- Sélecteur de guilds (chargé selon /api/guilds avec user ou non) -->
  <select id="configGuild" class="config-input" title="Serveur Discord">
    <option value="">— Charge les serveurs… —</option>
  </select>

  <!-- (Plus besoin de saisir l’ID utilisateur manuellement en mode OAuth) -->
  <div style="display:flex; gap:8px; margin-top:6px;">
    <button class="config-save" id="configSave" style="flex:1;">Sauvegarder</button>
    <button class="config-save" id="configReload" style="flex:0 0 160px; background:#475569;">Recharger serveurs</button>
  </div>

  <div id="statusMessage" class="status-message"></div>
</div>

<div class="player-container" id="playerContainer">
  <button class="collapse-btn" id="collapseBtn" title="Réduire/Agrandir">▼</button>

  <div class="player-content">
    <div class="add-url-container">
      <input type="text" id="urlInput" class="add-url-input"
             placeholder="Ajouter une URL ou rechercher..." autocomplete="off" />
      <button class="add-url-btn" id="addBtn" title="Ajouter">+</button>
      <div class="suggestions-container hidden" id="suggestions"></div>
    </div>

    <div class="track-info">
      <div class="track-artwork" id="artwork">🎵</div>
      <div class="track-title" id="trackTitle">Aucune piste</div>
      <div class="track-artist" id="trackArtist">En attente...</div>
    </div>

    <div class="progress-container">
      <div class="progress-bar" id="progressBar" title="(Seek bientôt)">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-time">
        <span id="currentTime">0:00</span>
        <span id="totalTime">0:00</span>
      </div>
    </div>

    <div class="controls-main">
      <button class="control-btn small"  id="stopBtn"       title="Arrêter">⏹️</button>
      <button class="control-btn medium" id="prevBtn"       title="Recommencer">⏮️</button>
      <button class="control-btn large"  id="playPauseBtn"  title="Lecture">▶️</button>
      <button class="control-btn medium" id="nextBtn"       title="Suivant">⏭️</button>
      <button class="control-btn small"  id="repeatBtn"     title="Répéter la file">🔁</button>
    </div>

    <div class="queue-container">
      <div class="queue-title">File d'attente</div>
      <div id="queueList"></div>
    </div>
  </div>
</div>

</body>
</html>
